library(readxl)
library(fBasics)#Analisis estadistico
library(aTSA)#Raiz Unitaria
library(tseries)#Raiz Unitaria
library(naniar)#remueve Nas
library(tidyverse)#Ya incluye read excel
library(PerformanceAnalytics)
library(textshape)
library(QuantPsyc)#Pruba multivariada de normlaidad
library(statmod)
library(ghyp)#multivariado NIG
library(cramer)#Pruba cramer NIG multivariada
g1<- read_excel("C:/Users/juanl/Desktop/paper/Correlaciones G1/Charting Excel Export - Jan 21st 2022 11_27_13 pm.xls")
colnames(g1)<-c("Fecha","SPX","OMXC","FTSE","KOSPI","MSCI")
#View(g1)
g1<-textshape::column_to_rownames(g1,loc=1)
g1<- read_excel("C:/Users/juanl/Desktop/paper/Correlaciones G1/Charting Excel Export - Jan 21st 2022 11_27_13 pm.xls")
colnames(g1)<-c("Fecha","SPX","OMXC","FTSE","KOSPI","MSCI")
#View(g1)
g1<-textshape::column_to_rownames(g1,loc=1)
```{r Limpieza de base}
g1<-drop_na(g1)
glimpse(g1)
#vis_miss(retornos)
#View(retornos)
```
#Parametros de la NIG
NIG<-nigFit(retornos$OMXC)
retornos<-Return.calculate(g1,method = "log")[-1,]
retornos<-drop_na(retornos)
#Parametros de la NIG
NIG<-nigFit(retornos$OMXC)
#Agrupar parametros en un objeto
a<-NIG@fit[["par"]]
a<-data.frame(t(a))
#NIG aleatoria con parametors univariados de nuestra serie
r = rnig(len,
alpha = a$alpha ,
beta = a$beta,
delta = a$delta ,
mu= a$mu)
plot(density(r),
col="red",
main="NIG Univariada",
sub="STI index")
#Parametros para NIG Multivariada
multNIG<-fit.NIGmv(data=retornos,silent=FALSE)
#Localizar parametros dentor de un obejto
Mom1NIGm<-multNIG@expected.value
Mom2NIGm<-multNIG@variance
Mom1NIGm
#Parametros para NIG Multivariada
multNIG<-fit.NIGmv(data=retornos,silent=FALSE)
#Localizar parametros dentor de un obejto
Mom1NIGm<-multNIG@expected.value
Mom2NIGm<-multNIG@variance
Mom1NIGm
Mom2NIGm
#Construccion de la funcion NIG con nuestros  parametros de la funcion multivariada
Mnig <- rghyp(len,multNIG)
retornos1<-as.matrix(retornos)
len<-length(retornos$SPX)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
g1<- read_excel("C:/Users/juanl/Desktop/paper/Correlaciones G1/Charting Excel Export - Jan 21st 2022 11_27_13 pm.xls")
g1<- read_excel("C:/Users/juanl/Desktop/paper/Correlaciones G1/Charting Excel Export - Jan 21st 2022 11_27_13 pm.xls")
library(readxl)
library(fBasics)#Analisis estadistico
library(aTSA)#Raiz Unitaria
library(tseries)#Raiz Unitaria
library(naniar)#remueve Nas
library(tidyverse)#Ya incluye read excel
library(PerformanceAnalytics)
library(textshape)
library(QuantPsyc)#Pruba multivariada de normlaidad
library(statmod)
library(ghyp)#multivariado NIG
library(cramer)#Pruba cramer NIG multivariada
colnames(g1)<-c("Fecha","SPX","OMXC","FTSE","KOSPI","MSCI")
#View(g1)
g1<-textshape::column_to_rownames(g1,loc=1)
g1<-drop_na(g1)
glimpse(g1)
g1<- read_excel("C:/Users/juanl/Desktop/paper/Correlaciones G1/Charting Excel Export - Jan 21st 2022 11_27_13 pm.xls")
colnames(g1)<-c("Fecha","SPX","OMXC","FTSE","KOSPI","MSCI")
#View(g1)
g1<-textshape::column_to_rownames(g1,loc=1)
g1<-drop_na(g1)
retornos<-Return.calculate(g1,method = "log10")[-1,]
g1<-Return.calculate(g1,method = "log10")[-1,]
library(PerformanceAnalytics)
g1<-Return.calculate(g1,method = "log10")[-1,]
g1<-Return.calculate(g1,method = "log")[-1,]
g1<-Return.calculate(g1,method = "log10")[-1,]
g1<-Return.calculate(g1,method = "log")[-1,]
g1<- read_excel("C:/Users/juanl/Desktop/paper/Correlaciones G1/Charting Excel Export - Jan 21st 2022 11_27_13 pm.xls")
colnames(g1)<-c("Fecha","SPX","OMXC","FTSE","KOSPI","MSCI")
#View(g1)
g1<-textshape::column_to_rownames(g1,loc=1)
g1<-Return.calculate(g1,method = "log")[-1,]
g1<- read_excel("C:/Users/juanl/Desktop/paper/Correlaciones G1/Charting Excel Export - Jan 21st 2022 11_27_13 pm.xls")
colnames(g1)<-c("Fecha","SPX","OMXC","FTSE","KOSPI","MSCI")
#View(g1)
g1<-textshape::column_to_rownames(g1,loc=1)
g1<-drop_na(g1)
glimpse(g1)
#vis_miss(retornos)
#View(retornos)
g1<-Return.calculate(g1)[-1,]
glimpse(g1)
View(g1)
g1<-log10(g1)
View(g1)
vis_miss(g1)
g1<-Return.calculate(g1,method = "log")[-1,]
g1<- read_excel("C:/Users/juanl/Desktop/paper/Correlaciones G1/Charting Excel Export - Jan 21st 2022 11_27_13 pm.xls")
colnames(g1)<-c("Fecha","SPX","OMXC","FTSE","KOSPI","MSCI")
#View(g1)
g1<-textshape::column_to_rownames(g1,loc=1)
g1<-drop_na(g1)
glimpse(g1)
g1<-Return.calculate(g1,method = "log")[-1,]
View(g1)
