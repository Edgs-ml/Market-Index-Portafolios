fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal
geom_point(alpha=0.5, col="#20129966")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#29201164", size=3)+ #optimo de la normal
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="grey")+ #portafolios al asar de la NIG
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
col="#203182", size = 3)
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal
geom_point(alpha=0.5, col="#29201164")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#29201164", size=3)+ #optimo de la normal
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="grey")+ #portafolios al asar de la NIG
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
col="#203182", size = 3)
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal
geom_point(alpha=0.5, col="red")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="blue", size=3)+ #optimo de la normal
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="yellow")+ #portafolios al asar de la NIG
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
col="green", size=3)
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal
geom_point(alpha=0.5, col="red")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="blue", size=3)+ #optimo de la normal
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="yellow")+ #portafolios al asar de la NIG
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
col="green", size=3)
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal
geom_point(alpha=0.5, col="red")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="blue", size=3)+ #optimo de la normal
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="yellow", shape=2)+ #portafolios al asar de la NIG
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
col="green", shape=2, size=3)
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="#71940209	")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#203182", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="#22654091", shape=2)+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
col="#20129066", shape=2, size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="#71940209")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#203182", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="#22654091", shape=2)+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
col="#20129066", shape=2, size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="#71940209")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#203182", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="#22654910")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
col="#20129660", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="#54226189")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#29201164", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="#22654910")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
col="#20129660", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="red", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="green", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#201,29,660", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="green", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#201,29,66", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="green", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#201,29,660", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="green", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#201,290,660", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="green", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#201,290,66", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="green", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#20,29,66", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="green", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="red", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.3, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="green", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="red", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.2, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="green", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="#71,094,209")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#20,31,82", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.2, col="#226,054,91")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="#201,029,66", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="#71,94,209")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#20,31,82", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.2, col="#226,054,91")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="#201,029,66", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="#71,94,29")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#20,31,82", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.2, col="#226,054,91")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="#201,029,66", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="#71,94,029")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="#20,31,82", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.2, col="#226,054,91")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="#201,029,66", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="red", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.2, col="midenightblue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="blue", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="red", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.2, col="green")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="blue", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port2$objective_measures$StdDev,
ExpectedRet = Optimized_Port2$objective_measures$mean),
col="red", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.2, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port1$objective_measures$StdDev,
ExpectedRet = Optimized_Port1$objective_measures$mean),
alpha=1, col="darkgreen", size=3) #Tokio45
library(quantmod)
library(PerformanceAnalytics)
library(PortfolioAnalytics)
library(DEoptim)
library(readxl)
library(fBasics)
library(ghyp)
library(naniar)
library(tidyverse)
library(readxl)
Optimizacion_NIG_alpha_1_2 <- read_excel("~/Documents/GitHub/Market-Index-Portafolios/APLHA/ALPHA 1/ALPHA 1.2/1.2.4 Optimización/Optimizacion NIG alpha 1.2.xlsx",
sheet = "Datos", col_types = c("date",
"numeric", "numeric", "numeric",
"numeric", "numeric"))
View(Optimizacion_NIG_alpha_1_2)
g1 <- Optimizacion_NIG_alpha_1_2
colnames(g1)<-c("Fecha","DJI","HSI","OMX20","STI","FTSE")
g1 %>%
vis_miss()
View(g1)
rendimientos <- xts(g1[,2:6], order.by = as.Date(g1$Fecha))
View(rendimientos)
Specs_Port1 <- portfolio.spec(c("DJI",	"HSI",	"OMX20",	"STI",	"FTSE"))
##### Add Constraints #####
Specs_Port1 <- add.constraint(Specs_Port1,type="full_investment")
Specs_Port1 <- add.constraint(Specs_Port1,type="long_only")
##### Add Objective #####
Specs_Port1 <- add.objective(Specs_Port1,type="risk",name="StdDev")
Specs_Port1 <- add.objective(Specs_Port1,type='return',name='mean')
Specs_Port1
?optimized.portafolio
?optimize.portfolio
covnig<-function(R,portfolio){
a<-fit.NIGmv(R,silent=TRUE)
COV<-a@variance
mu<-a@expected.value
mu<-matrix(mu,ncol = 1)
resultado<-list(mu=mu,sigma=COV)
return(resultado)
}
Optimized_Port1 <- optimize.portfolio(rendimientos,
Specs_Port1,
momentFUN = covnig,
optimize_method = "random",
trace = TRUE)
chart.Weights(Optimized_Port1, plot.type = "barplot")
Return_opt1 <- Return.portfolio(rendimientos, W_R)
W_R <- extractWeights(Optimized_Port1)
Return_opt1 <- Return.portfolio(rendimientos, W_R)
table.AnnualizedReturns(Return_opt1,
scale = 252,
geometric = FALSE)
library(readxl)
Optimizacion_NIG_alpha_1_2 <- read_excel("~/Documents/GitHub/Market-Index-Portafolios/APLHA/ALPHA 1/ALPHA 1.2/1.2.4 Optimización/Optimizacion NIG alpha 1.2.xlsx",
sheet = "Datos", col_types = c("date",
"numeric", "numeric", "numeric",
"numeric", "numeric"))
View(Optimizacion_NIG_alpha_1_2)
g1 <- Optimizacion_NIG_alpha_1_2
colnames(g1)<-c("Fecha","DJI","HSI","OMX20","STI","FTSE")
rendimientos <- xts(g1[,2:6], order.by = as.Date(g1$Fecha))
#------------- Creación de portafolio
Specs_Port1 <- portfolio.spec(c("DJI",	"HSI",	"OMX20",	"STI",	"FTSE"))
##### Add Constraints #####
Specs_Port1 <- add.constraint(Specs_Port1,type="full_investment")
Specs_Port1 <- add.constraint(Specs_Port1,type="long_only")
##### Add Constraints #####
Specs_Port <- add.constraint(Specs_Port,type="full_investment")
#------------- Creación de portafolio
Specs_Port <- portfolio.spec(c("DJI",	"HSI",	"OMX20",	"STI",	"FTSE"))
##### Add Constraints #####
Specs_Port <- add.constraint(Specs_Port,type="full_investment")
Specs_Port <- add.constraint(Specs_Port,type="long_only")
##### Add Objective #####
Specs_Port <- add.objective(Specs_Port,type="risk",name="StdDev")
Specs_Port <- add.objective(Specs_Port,type='return',name='mean')
Specs_Port
covnig<-function(R,portfolio){
a<-fit.NIGmv(R,silent=TRUE)
COV<-a@variance
mu<-a@expected.value
mu<-matrix(mu,ncol = 1)
resultado<-list(mu=mu,sigma=COV)
return(resultado)
}
Optimized_Port_Normal <- optimize.portfolio(rendimientos,
Specs_Port1,
optimize_method = "random",
trace = TRUE)
Optimized_Port_NIG <- optimize.portfolio(rendimientos,
Specs_Port1,
momentFUN = covnig,
optimize_method = "random",
trace = TRUE)
Optimized_Port_NIG <- optimize.portfolio(rendimientos,
Specs_Port1,
momentFUN = covnig,
optimize_method = "random",
trace = TRUE)
library(readxl)
Optimizacion_NIG_alpha_1_2 <- read_excel("~/Documents/GitHub/Market-Index-Portafolios/APLHA/ALPHA 1/ALPHA 1.2/1.2.4 Optimización/Optimizacion NIG alpha 1.2.xlsx",
sheet = "Datos", col_types = c("date",
"numeric", "numeric", "numeric",
"numeric", "numeric"))
View(Optimizacion_NIG_alpha_1_2)
g1 <- Optimizacion_NIG_alpha_1_2
colnames(g1)<-c("Fecha","DJI","HSI","OMX20","STI","FTSE")
rendimientos <- xts(g1[,2:6], order.by = as.Date(g1$Fecha))
#------------- Creación de portafolio
Specs_Port <- portfolio.spec(c("DJI",	"HSI",	"OMX20",	"STI",	"FTSE"))
##### Add Constraints #####
Specs_Port <- add.constraint(Specs_Port,type="full_investment")
Specs_Port <- add.constraint(Specs_Port,type="long_only")
##### Add Objective #####
Specs_Port <- add.objective(Specs_Port,type="risk",name="StdDev")
Specs_Port <- add.objective(Specs_Port,type='return',name='mean')
Specs_Port
Optimized_Port_Normal <- optimize.portfolio(rendimientos,
Specs_Port,
optimize_method = "random",
trace = TRUE)
View(Optimizacion_NIG_alpha_1_2)
covnig<-function(R,portfolio){
a<-fit.NIGmv(R,silent=TRUE)
COV<-a@variance
mu<-a@expected.value
mu<-matrix(mu,ncol = 1)
resultado<-list(mu=mu,sigma=COV)
return(resultado)
}
Optimized_Port_NIG <- optimize.portfolio(rendimientos,
Specs_Port,
momentFUN = covnig,
optimize_method = "random",
trace = TRUE)
#--------------
#-------------- Análisis de portafolios
chart.Weights(Optimized_Port_Normal, plot.type = "barplot")
chart.Weights(Optimized_Port_NIG, plot.type = "barplot")
W_R_NIG <- extractWeights(Optimized_Port_NIG)
W_R_NIG
sum(W_R_NIG)
Return_Port_Normal <- Return.portfolio(rendimientos, W_R_Normal)
W_R_Normal
#--------------
#-------------- Análisis de portafolios
chart.Weights(Optimized_Port_Normal, plot.type = "barplot")
W_R_Normal <- extractWeights(Optimized_Port_Normal)
W_R_Normal
sum(W_R_Normal)
Return_Port_Normal <- Return.portfolio(rendimientos, W_R_Normal)
table.AnnualizedReturns(Return_Port_Normal,
scale = 252,
geometric = FALSE)
Return.cumulative(Return_Port_Normal,
geometric = FALSE)
chart.RiskReward(Optimized_Port_Normal,
risk.col = 'StdDev',
return.col = 'mean',
chart.assets = TRUE)
chart.RiskReward(Optimized_Port_NIG,
risk.col = 'StdDev',
return.col = 'mean',
chart.assets = TRUE)
Return.cumulative(Return_Port_NIG,
geometric = FALSE)
Return_Port_NIG <- Return.portfolio(rendimientos, W_R_NIG)
table.AnnualizedReturns(Return_Port_NIG,
scale = 252,
geometric = FALSE)
Return.cumulative(Return_Port_NIG,
geometric = FALSE)
#--------
mediasNORM <- NULL
standDevNORM <- NULL
for (i in 1:1722) {
mediasNORM[i] <- Optimized_Port2$random_portfolio_objective_results[[i]]$objective_measures$mean
standDevNORM[i] <- Optimized_Port2$random_portfolio_objective_results[[i]]$objective_measures$StdDev
}
View(Optimized_Port_Normal)
for (i in 1:1682) {
mediasNORM[i] <- Optimized_Port_Normal$random_portfolio_objective_results[[i]]$objective_measures$mean
standDevNORM[i] <- Optimized_Port_Normal$random_portfolio_objective_results[[i]]$objective_measures$StdDev
}
mediasNIG <- NULL
standDeviNIG <- NULL
View(Optimized_Port_NIG)
for (i in 1:1768) {
medias[i] <- Optimized_Port_NIG$random_portfolio_objective_results[[i]]$objective_measures$mean
standDevi[i] <- Optimized_Port_NIG$random_portfolio_objective_results[[i]]$objective_measures$StdDev
}
for (i in 1:1768) {
mediasNIG[i] <- Optimized_Port_NIG$random_portfolio_objective_results[[i]]$objective_measures$mean
standDeviNIG[i] <- Optimized_Port_NIG$random_portfolio_objective_results[[i]]$objective_measures$StdDev
}
#-------- Fronteras
fronteraNorm <- tibble(Volatility = standDevNORM, Expected_Return = mediasNORM)
fronteraNIG <- tibble(Volatility = standDeviNIG, Expected_Return = mediasNIG)
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(volatilidad = Optimized_Port_Normal$objective_measures$StdDev,
ExpectedRet = Optimized_Port_Normal$objective_measures$mean),
col="red", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.2, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(volatilidad = Optimized_Port_NIG$objective_measures$StdDev,
ExpectedRet = Optimized_Port_NIG$objective_measures$mean),
alpha=1, col="darkgreen", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=volatilidad, y=ExpectedRet))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(Volatility = Optimized_Port_Normal$objective_measures$StdDev,
Expected_Return = Optimized_Port_Normal$objective_measures$mean),
col="red", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=volatilidad, y=ExpectedRet), alpha=0.2, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(Volatility = Optimized_Port_NIG$objective_measures$StdDev,
Expected_Return = Optimized_Port_NIG$objective_measures$mean),
alpha=1, col="darkgreen", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=Volatility, y=Expected_Return))+ #portafolios al asar de la normal Chicago55
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(Volatility = Optimized_Port_Normal$objective_measures$StdDev,
Expected_Return = Optimized_Port_Normal$objective_measures$mean),
col="red", size=3)+ #optimo de la normal Chicago20
geom_point(data=fronteraNIG, aes(x=Volatility, y=Expected_Return), alpha=0.2, col="blue")+ #portafolios al asar de la NIG Toki055
geom_point(data=tibble(Volatility = Optimized_Port_NIG$objective_measures$StdDev,
Expected_Return = Optimized_Port_NIG$objective_measures$mean),
alpha=1, col="darkgreen", size=3) #Tokio45
fronteraNorm %>%
ggplot(aes(x=Volatility, y=Expected_Return))+
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(Volatility = Optimized_Port_Normal$objective_measures$StdDev,
Expected_Return = Optimized_Port_Normal$objective_measures$mean),
col="red", size=3)+
geom_point(data=fronteraNIG, aes(x=Volatility, y=Expected_Return), alpha=0.2, col="blue")+
geom_point(data=tibble(Volatility = Optimized_Port_NIG$objective_measures$StdDev,
Expected_Return = Optimized_Port_NIG$objective_measures$mean),
alpha=1, col="darkgreen", size=3)+
labs(fill="NIG")
Frontera <- fronteraNorm %>%
ggplot(aes(x=Volatility, y=Expected_Return))+
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(Volatility = Optimized_Port_Normal$objective_measures$StdDev,
Expected_Return = Optimized_Port_Normal$objective_measures$mean),
col="red", size=3)+
geom_point(data=fronteraNIG, aes(x=Volatility, y=Expected_Return), alpha=0.2, col="blue")+
geom_point(data=tibble(Volatility = Optimized_Port_NIG$objective_measures$StdDev,
Expected_Return = Optimized_Port_NIG$objective_measures$mean),
alpha=1, col="darkgreen", size=3)
View(Frontera)
Frontera + theme(legend.position = "bottom",
legend.box = "vertical")
fronteraNorm %>%
ggplot(aes(x=Volatility, y=Expected_Return))+
geom_point(alpha=0.5, col="pink")+
geom_point(data=tibble(Volatility = Optimized_Port_Normal$objective_measures$StdDev,
Expected_Return = Optimized_Port_Normal$objective_measures$mean),
col="red", size=3)+
geom_point(data=fronteraNIG, aes(x=Volatility, y=Expected_Return), alpha=0.2, col="blue")+
geom_point(data=tibble(Volatility = Optimized_Port_NIG$objective_measures$StdDev,
Expected_Return = Optimized_Port_NIG$objective_measures$mean),
alpha=1, col="darkgreen", size=3)
