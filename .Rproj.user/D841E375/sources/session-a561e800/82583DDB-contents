# Load required libraries
library(httr)
library(jsonlite)

# API endpoint for Global Competitiveness Index data
url <- "https://api.imd.org/GCI/DownloadHistoricalData"

# Set request parameters
params <- list(
  indicator = "GCI",
  report = "HISTORICAL",
  year = 2020,  # Replace with the desired year
  fileType = "XLSX"
)

# Send GET request to the API
response <- GET(url, query = params)

# Check if the request was successful
if (status_code(response) == 200) {
  # Specify the path to save the downloaded file
  file_path <- "GlobalCompetitivenessIndex.xlsx"  # Replace with desired file name and extension
  
  # Save the response content to a file
  content(response, as = "raw") %>%
    writeBin(file_path)
  
  # Load the downloaded file into a data frame
  data <- read.xlsx(file_path, sheet = 1)  # Assumes data is on the first sheet
  
  # Print the first few rows of the data frame
  head(data)
} else {
  # If the request was not successful, print the error message
  print(paste("Error:", status_code(response)))
}
