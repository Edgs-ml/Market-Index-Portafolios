# Kmean
NB_df_gdplog <- NbClust(df_gdplog,
distance = "euclidean",
method = "kmeans")
kmean1_df_gdplog <- kmeans(df_gdplog, 8)
fviz_cluster(kmean1_df_gdplog,
data = df_gdplog)
k1_map_df_gdplog <- as.data.frame(kmean1_df_gdplog$cluster)
View(k1_map_df_gdplog)
k1_map <- as.data.frame(kmean1_df_gdplog$cluster)
k_map <- kmeans(coordinates_map,
centers = 5,
iter.max = 20)
# Kmean
NB_df_gdplog <- NbClust(df_gdplog,
distance = "euclidean",
method = "kmeans")
kmean1_df_gdplog <- kmeans(df_gdplog,
centers = 8,
iter.max = 20)
fviz_cluster(kmean1_df_gdplog,
data = df_gdplog)
k1_map <- as.data.frame(kmean1_df_gdplog$cluster)
View(k1_map)
k1_map_dfgdplog_C1 <- k1_map  %>%
subset(`kmean1_df_gdplog$cluster`==1)
View(k1_map_dfgdplog_C1)
k1_map_C1 <- k1_map  %>%
subset(`kmean1_df_gdplog$cluster`==1)
View(k1_map_C1)
kmean1_df_gdplogdf <- as.data.frame(kmean1_df_gdplog)
kmean1_df_gdplogdf <- cbind(df_gdplog, as.data.frame(kmean1_df_gdplog$cluster))
View(kmean1_df_gdplogdf)
kmean1_df_gdplogdf <- cbind(df_gdplog,
K_C1 = as.data.frame(kmean1_df_gdplog$cluster))
View(kmean1_df_gdplogdf)
kmean1_df_gdplogdf <- cbind(df_gdplog,
"K_C1" = as.data.frame(kmean1_df_gdplog$cluster))
View(kmean1_df_gdplogdf)
colnames(kmean1_df_gdplogdf)[5] = "k_C1"
kmean1_df_gdplogdf <- cbind(df_gdplog,
as.data.frame(kmean1_df_gdplog$cluster)) %>%
arrange(desc(kmean1_df_gdplogdf$k_C1))
kmean1_df_gdplogdf <- cbind(df_gdplog,
as.data.frame(kmean1_df_gdplog$cluster)) %>%
arrange(kmean1_df_gdplogdf$k_C1)
# Kmean
NB_df_gdplog <- NbClust(df_gdplog,
distance = "euclidean",
method = "kmeans")
kmean1_df_gdplog <- kmeans(df_gdplog,
centers = 8,
iter.max = 20)
fviz_cluster(kmean1_df_gdplog,
data = df_gdplog)
kmean1_df_gdplogdf <- cbind(df_gdplog,
as.data.frame(kmean1_df_gdplog$cluster))
colnames(kmean1_df_gdplogdf)[5] = "k1"
View(kmean1_df_gdplogdf)
df_gdplog_k1C1 <- kmean1_df_gdplogdf %>%
filter(k1==1)
View(df_gdplog_k1C1)
df_gdplog_k1C1 <- kmean1_df_gdplogdf %>%
filter(k1==1) %>%
[,-5]
df_gdplog_k1C1 <- kmean1_df_gdplogdf %>%
filter(k1==1) %>%
kmean1_df_gdplogdf[,-5]
df_gdplog_k1C1 <- kmean1_df_gdplogdf %>%
filter(k1==1) %>%
df_gdplog_k1C1[,-5]
df_gdplog_k1C1 <- kmean1_df_gdplogdf %>%
filter(k1==1)
df_gdplog_k1C1[,-5]
View(df_gdplog_k1C1)
df_gdplog_k1C1 <- df_gdplog_k1C1[,-5]
kmean2_df_gdplog <- kmeans(df_gdplog_k1C1,
centers = 2,
iter.max = 10)
View(df_gdplog)
fviz_cluster(kmean2_df_gdplog,
data = df_gdplog_k1C1)
kmean2_df_gdplogdf <- cbind(df_gdplog_k1C1,
as.data.frame(kmean2_df_gdplog$cluster))
colnames(kmean2_df_gdplogdf)[5] = "k2"
View(kmean2_df_gdplogdf)
hclust.out <- hclust(dist(pca_df_gdplog))
View(pca_df_gdplog)
library(tidyverse)
library(readxl)
library(textshape) #"Tools for Reshaping Text". Usado en columns_to_rownames
library(broom)
library(plotly)
library(scales)
library(caTools)
library(caret)
library(cluster)
library(factoextra) #Para graficar K-Means y PCA
library(psych) #Usado por su funsión de crar matices de correlaciones de colores
library(stats) #Para hacer el PCA
library(naniar) #Para limpiar las bases de datos
library(fBasics) #Analisis estadistico
library(PerformanceAnalytics)
library(statmod)
library(knitr)
library(stargazer)
library(kableExtra)
library(ggpubr)
library(ggdist)
library(ggExtra)
library(ggbeeswarm)
library(aTSA) #Raiz Unitaria
library(tseries) #Raiz Unitaria
library(QuantPsyc) #Pruba multivariada
library(ghyp) #Para hacer momentos estadisticos de la NIG
library(quantmod) #Para descargar datos
library(cramer) #Para la prueba de cramer
library(PortfolioAnalytics)
library(DEoptim)
library(tidyquant)
library(NbClust)
df <- read_excel("APLHA/ALPHA_1/ALPHA_1.1/1.1.1PCA_Codes/Criterios-Unificado (Datos para PCA).xlsx")
df <- df[,-6]
df_plot <- df #Data Frame para hacer gráficas descriptivas
df <- column_to_rownames(df, loc = 1)
df_gdplog_plot <- cbind(df_plot[,-5], log10(df$GDP))
colnames(df_gdplog_plot)[5] = "GDP"
df_gdplog <- column_to_rownames(df_gdplog_plot, loc = 1)
df_gdplog_plot %>%
ggplot(aes(x=GDP))+
geom_histogram(bins=100)+
geom_label(data = df_gdplog_plot %>%
filter(GDP>13), aes(x=GDP,y=Country,
label=Country))
# PCA con df_gdplog
pca_df_gdplog <- prcomp(df_gdplog,
center = TRUE,
scale. = TRUE)
summary(pca_df_gdplog)
biplot(pca_df_gdplog)
fviz_pca_ind(pca_df_gdplog)
fviz_pca_biplot(pca_df_gdplog)
fviz_contrib(pca_df_gdplog,
choice = "var")
fviz_pca_biplot(pca_df_gdplog)
fviz_contrib(pca_df_gdplog,
choice = "ind")
fviz_screeplot(pca_df_gdplog)
df_gdplog_PC1234 <- cbind(df_gdplog, pca_df_gdplog$x) %>%
arrange(desc(PC1))
View(df_gdplog_PC1234)
df_PC12 <- as.data.frame(pca_df_gdplog$x)
View(pca_df_gdplog$x)
df_PC12 <- as.data.frame(pca_df_gdplog$x[PC1, PC2])
df_Pc12 <- df_PC12[PC1, PC2]
df_Pc12 <- df_PC12[,PC1:PC2]
df_Pc12 <- df_PC12[,"PC1":"PC2"]
df_PC12 <- df_PC12[,1:2]
View(df_PC12)
# Kmeans sobre el PCA
NB_df_PC12 <- NbClust(df_PC12,
distance = "euclidean",
method = "kmeans")
kmean1_df_PC12 <- kmeans(df_PC12,
centers = 3,
iter.max = 50) #creamos objeto de kmeans con la df principal
fviz_cluster(kmean1_df_PC12,
data = df_PC12)
library(tidyverse)
library(readxl)
library(textshape) #"Tools for Reshaping Text". Usado en columns_to_rownames
library(broom)
library(plotly)
library(scales)
library(caTools)
library(caret)
library(cluster)
library(factoextra) #Para graficar K-Means y PCA
library(psych) #Usado por su funsión de crar matices de correlaciones de colores
library(stats) #Para hacer el PCA
library(naniar) #Para limpiar las bases de datos
library(fBasics) #Analisis estadistico
library(PerformanceAnalytics)
library(statmod)
library(knitr)
library(stargazer)
library(kableExtra)
library(ggpubr)
library(ggdist)
library(ggExtra)
library(ggbeeswarm)
library(aTSA) #Raiz Unitaria
library(tseries) #Raiz Unitaria
library(QuantPsyc) #Pruba multivariada
library(ghyp) #Para hacer momentos estadisticos de la NIG
library(quantmod) #Para descargar datos
library(cramer) #Para la prueba de cramer
library(PortfolioAnalytics)
library(DEoptim)
library(tidyquant)
library(NbClust)
# Creación de las Data Frames
df <- read_excel("APLHA/ALPHA_1/ALPHA_1.1/1.1.1PCA_Codes/Criterios-Unificado (Datos para PCA).xlsx")
df <- df[,-6]
df_plot <- df #Data Frame para hacer gráficas descriptivas
df <- column_to_rownames(df, loc = 1)
df_gdplog_plot <- cbind(df_plot[,-5], log10(df$GDP))
colnames(df_gdplog_plot)[5] = "GDP"
df_gdplog <- column_to_rownames(df_gdplog_plot, loc = 1)
# Graficas descriptivas de las variables
df_gdplog_plot %>%
ggplot(aes(x=GDP))+
geom_histogram(bins=100)+
geom_label(data = df_gdplog_plot %>%
filter(GDP>13), aes(x=GDP,y=Country,
label=Country))
# PCA con df_gdplog
pca_df_gdplog <- prcomp(df_gdplog,
center = TRUE,
scale. = TRUE)
summary(pca_df_gdplog)
biplot(pca_df_gdplog)
fviz_pca_biplot(pca_df_gdplog)
fviz_contrib(pca_df_gdplog,
choice = "var")
fviz_contrib(pca_df_gdplog,
choice = "ind")
fviz_screeplot(pca_df_gdplog)
df_gdplog_PC1234 <- cbind(df_gdplog, pca_df_gdplog$x) %>%
arrange(desc(PC1))
View(df_gdplog_PC1234)
df_PC12 <- as.data.frame(pca_df_gdplog$x)
df_PC12 <- df_PC12[,1:2]
View(df_PC12)
# Kmeans sobre el PCA
NB_df_PC12 <- NbClust(df_PC12,
distance = "euclidean",
method = "kmeans")
kmean1_df_PC12 <- kmeans(df_PC12,
centers = 3,
iter.max = 50) #creamos objeto de kmeans con la df principal
fviz_cluster(kmean1_df_PC12,
data = df_PC12)
View(kmean1_df_PC12)
## Segundo kmeans sobre PC12
df_K1C1 <- merge(df_PC12, kmean1_df_PC12$cluster)
View(df_K1C1)
## Segundo kmeans sobre PC12
df_K1C1 <- cbind(df_gdplog,
as.data.frame(kmean1_df_gdplog$cluster))
## Segundo kmeans sobre PC12
df_K1C1 <- cbind(df_PC12,
as.data.frame(kmean1_df_PC12$cluster))
colnames(df_K1C1)[3] = K1C1
colnames(df_K1C1)[3] = "K1C1"
## Segundo kmeans sobre PC12
df_K1C1 <- cbind(df_PC12,
as.data.frame(kmean1_df_PC12$cluster)) %>%
colnames(df_K1C1)[3] = "K1C1"
df_K1C1 <- df_K1C1 %>%
filter(K1C1==1)
df_K1C1 <- df_K1C1 %>%
filter(K1C1==3)
## Segundo kmeans sobre PC12
df_K1C1 <- cbind(df_PC12,
as.data.frame(kmean1_df_PC12$cluster))
colnames(df_K1C1)[3] = "K1C1"
df_K1C1 <- df_K1C1 %>%
filter(K1C1==3)
df_K1C1 <- df_K1C1[,-3]
#----
NbClust(df_K1C1,
distance = "euclidean",
method = "kmeans")
kmean2_df_PC12 <- kmeans(df_K1C1,
centers = 2,
iter.max = 50)
fviz_cluster(kmean2_df_PC12,
data = df_K1C1)
kmean2_df_PC12 <- kmeans(df_K1C1,
centers = 4,
iter.max = 50)
fviz_cluster(kmean2_df_PC12,
data = df_K1C1)
hclust.out <- hclust(dist(df_PC12))
summary(hclust.out)
agn_pc1 <- agnes(pc1_df1, method = "ward")
agn_pc1 <- agnes(df_PC12,
method = "ward")
pltree(agn_pc1)
cutree(hclust.out, h=2)
ct <- cutree(hclust.out, h=2)
View(ct)
ct <- pltree(agn_pc1)
View(ct)
hc_m <- c("average", "single", "complete", "ward")
names(hc_m) <- c("average", "single", "complete", "ward")
ac <- function(x){
agnes(pc1_df1,
method = x
)$ac
}
sapply(hc_m, ac)
hc_m <- c("average", "single", "complete", "ward")
names(hc_m) <- c("average", "single", "complete", "ward")
ac <- function(x){
agnes(df_PC12,
method = x
)$ac
}
sapply(hc_m, ac)
agn_pc1 <- agnes(df_PC12,
method = "ward")
ct <- pltree(agn_pc1)
View(ct)
ct
fviz_cluster(kmean2_df_PC12,
data = df_K1C1)
kmean2_df_PC12 <- kmeans(df_K1C1,
centers = 5,
iter.max = 50)
fviz_cluster(kmean2_df_PC12,
data = df_K1C1)
install.packages('dendextend')
library(dendextend)
hc.out <- as.dendrogram(hclust.out)
color_branches(hc.out)
fviz_dend(hc.out)
cutree(hclust.out, k=4)
c3 <- cutree(hclust.out, k=4)
View(c3)
hclust.out <- hclust(dist(df_PC12))
summary(hclust.out)
View(hclust.out)
hclust.out[["order"]]
fviz_dend(hc.out)
cutree(hc.out, k=3)
clusters3_5 <- cutree(hc.out, k=c(3:5))
View(clusters3_5)
clusters3_5 <- cutree(hc.out, k=c(5))
View(clusters3_5)
View(clusters3_5)
clusters3_5 <- cutree(hc.out, k=6)
View(clusters3_5)
clusters6 <- cutree(hc.out, k=6)
clusters6 <- cutree(hc.out, k=6)
View(c6)
clusters6
View(clusters6)
c6 <- clusters6 %>%
subset(Value=6)
c6 <- as.data.frame(clusters6)
View(clusters6)
View(c6)
hclust.out <- hclust(dist(df_PC12))
summary(hclust.out)
clusters6 <- cutree(hc.out, h = height_threshold)
clusters6 <- cutree(hc.out, h = 7)
# Get the unique cluster labels and count
num_clusters <- length(unique(clusters))
# Get the unique cluster labels and count
num_clusters <- length(unique(clusters6))
# Print the number of clusters
print(num_clusters)
clusters6 <- cutree(hc.out, h = 4)
# Get the unique cluster labels and count
num_clusters <- length(unique(clusters6))
# Print the number of clusters
print(num_clusters)
hclust.out <- hclust(dist(df_PC12))
summary(hclust.out)
fviz_dend(hclust.out)
clusters6 <- cutree(hc.out, k = 7)
c6 <- as.data.frame(clusters6)
color_branches(hclust.out,
k=7)
rank_branches(hclust.out, diff_height = 1)
hc.out.dend <- as.dendrogram(hclust.out)
rank_branches(hc.out.dend, diff_height = 1)
branch.height <- get_branches_heights(dend,
sort = TRUE,
decreasing = FALSE,
include_leaves = FALSE)
branch.height <- get_branches_heights(hc.out.dend,
sort = TRUE,
decreasing = FALSE,
include_leaves = FALSE)
View(branch.height)
branch.height
branch.height <- as.data.frame(branch.height)
branch.height <- get_branches_heights(hc.out.dend,
sort = F,
decreasing = FALSE,
include_leaves = FALSE)
branch.height <- as.data.frame(branch.height)
View(branch.height)
fviz_dend(hclust.out,
color_labels_by_k = T)
fviz_dend(hclust.out,
type = "circular",
color_labels_by_k = T)
branch.height <- get_branches_heights(hc.out.dend,
sort = FALSE,
decreasing = FALSE,
include_leaves = FALSE)
branch.height <- as.data.frame(branch.height)
View(branch.height)
View(df_PC12)
fviz_dend(hclust.out,
color_labels_by_k = T)
fviz_dend(hclust.out,
rect_border = 2:5
color_labels_by_k = T)
fviz_dend(hclust.out,
rect_border = 2:5,
color_labels_by_k = T)
fviz_dend(hclust.out,
rect_border = 1,
color_labels_by_k = T)
fviz_dend(hclust.out,
rect_border = 7,
color_labels_by_k = T)
clusters6 <- cutree(hc.out, k = 3)
diana(df_PC12,
metric = "euclidean")
dianac <- as.data.frame(diana(df_PC12,
metric = "euclidean"))
dianac <- diana(df_PC12,
metric = "euclidean")
View(dianac)
#chatgpt
clusters <- cutree(hc.out.dend, h = 2)
# Determine the number of clusters
num_clusters <- length(unique(clusters))
# Print the number of clusters
print(num_clusters)
#chatgpt
clusters <- cutree(hc.out.dend, h = 1.5)
# Determine the number of clusters
num_clusters <- length(unique(clusters))
# Print the number of clusters
print(num_clusters)
clusters <- cutree(hc.out, h = 1.7)
ch <- as.data.frame(clusters)
View(ch)
fviz_dend(hclust.out,
rect_border = 7)+
abline(h=1.5, col="red")
fviz_dend(hclust.out,
rect_border = 7)+
abline(h=6, col="red")
plot(hclust.out)+
abline(h=3, col = "red")
fviz_dend(hclust.out)+
abline(h=6, col="red")
plot(hclust.out)+
abline(h=3, col = "red")
plot(hclust.out)+
abline(h=3, col = "red")
plot(hc.out.dend)+
abline(h=3, col = "red")
plot(hc.out.dend)+
abline(h=1.5, col = "red")
plot(hc.out.dend)+
abline(h=1.7, col = "red")
plot(hc.out.dend)+
abline(h=1.4, col = "red")
clusters <- cutree(hc.out, h = 1.4)
ch <- as.data.frame(clusters)
View(ch)
ch16 <- ch %>%
filter(clusters = 16)
ch16 <- ch %>%
filter(clusters == 16)
View(ch16)
fviz_dend(hclust.out,
repel = TRUE,
rect = TRUE
color_labels_by_k = TRUE)
fviz_dend(hclust.out,
repel = TRUE,
rect = TRUE,
color_labels_by_k = TRUE)
fviz_dend(hclust.out,
repel = TRUE,
rect = TRUE,
color_labels_by_k = TRUE)+
abline(h=1.4, col = "red")
fviz_dend(hclust.out,
repel = TRUE,
rect = TRUE,
color_labels_by_k = TRUE)
hclust.out <- hclust(dist(df_PC12))
summary(hclust.out)
hc.out.dend <- as.dendrogram(hclust.out)
fviz_dend(hclust.out,
repel = TRUE,
rect = TRUE,
color_labels_by_k = TRUE)
plot(hc.out.dend)+
abline(h=1.4, col = "red")
branch.height <- get_branches_heights(hc.out.dend,
sort = FALSE,
decreasing = FALSE,
include_leaves = FALSE)
branch.height <- as.data.frame(branch.height)
View(branch.height)
clusters <- cutree(hc.out, h = 1.4)
ch <- as.data.frame(clusters)
summary(hc.out.dend)
View(hc.out.dend)
View(hclust.out)
