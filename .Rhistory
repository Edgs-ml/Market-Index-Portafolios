adf.table <- read_excel("adf.table.xlsx")
adf.table <- column_to_rownames(adf.table, loc = 1)
colnames(adf.table) <- new_names
adf.table %>%
ggplot(aes("Dickey-Fuller"))+
geom_bar()
adf.table <- read_excel("adf.table.xlsx", sheet = "Sheet2")
names(adf.table)[names(adf.table) == '...1'] <- 'Country'
adf.table <- column_to_rownames(adf.table, loc = 1)
adf.table <- read_excel("adf.table.xlsx", sheet = "Sheet2")
adf.table <- column_to_rownames(adf.table, loc = 1)
adf.table %>%
ggplot(aes("Dickey-Fuller"))+
geom_bar()
adf.table <- read_excel("adf.table.xlsx", sheet = "Sheet2")
names(adf.table)[names(adf.table) == '...1'] <- 'Country'
adf.table %>%
ggplot(aes(x="Country", y="Dickey-Fuller"))+
geom_bar()
adf.table %>%
ggplot(aes(x="Country", y="Dickey-Fuller"))+
geom_col()
adf.table %>%
ggplot(aes(x=Country, y="Dickey-Fuller"))+
geom_col()
adf.table %>%
ggplot(aes(x=Country, y=`p-value`))+
geom_col()
adf.table <- arrange(desc(adf.table$`p-value`))
adf.table <- adf.table %>%
arrange(desc(`p-value`))
adf.table %>%
ggplot(aes(x=Country, y=`p-value`))+
geom_col()
adf.table %>%
ggplot(aes(x=Country, y=`p-value`))+
geom_col()+
abline(b=0.05)
adf.table %>%
ggplot(aes(x=Country, y=`p-value`))+
geom_col()+
abline(h=0.05)
adf.table %>%
ggplot(aes(x=Country, y=`p-value`))+
geom_col()+
abline(a = NULL,
b = NULL,
h = 0.05,
v = NULL,
reg = NULL,
coef = NULL)
adf.table %>%
ggplot(aes(x=Country, y=`p-value`))+
geom_col()+
abline(a = NULL,
b = NULL,
h = 0.05,
v = 0,
reg = NULL,
coef = NULL)
adf.table %>%
ggplot(aes(x=Country, y=`p-value`))+
geom_col()+
abline(h = 0.05)
adf.table <- adf.table %>%
arrange(desc(`p-value`)) %>%
ggplot(aes(x=Country, y=`p-value`))+
geom_col()
adf.table %>%
arrange(desc(`p-value`)) %>%
ggplot(aes(x=Country, y=`p-value`))+
geom_col()
adf.table <- adf.table %>%
arrange(desc(`p-value`))
adf.table <- adf.table %>%
arrange(desc(`p-value`))
View(adf.table)
adf.table <- read_excel("adf.table.xlsx", sheet = "Sheet2")
names(adf.table)[names(adf.table) == '...1'] <- 'Country'
adf.table <- adf.table %>%
arrange(desc(`p-value`))
adf.table %>%
ggplot(aes(x=Country, y=`p-value`))+
geom_col()
adf.table %>%
ggplot(aes(x=Country, y=`p-value`))+
geom_col()+
abline(h = 0.05)
# Sequence
seq <- c(1:10)
# Print loop
for (value in seq) {
print(value)
}
stock <- as.data.frame(list(date=1:29,
"apple"=runif(29, 108, 120)))
View(stock)
# Loop over stock rows
for (row in 1:nrow(stock)) {
price <- stock[row, "apple"]
date  <- stock[row, "date"]
if(price > 116) {
print(paste("On", stock,
"the stock price was", price))
} else {
print(paste("The date:", date,
"is not an important day!"))
}
}
base.normal.fun <- function(serie){
for(col in 1:ncol(serie)){
m <- mean(col)
}
}
base.normal.fun(k3c2_matrix)
adftable[["United States"]][["statistic"]][["Dickey-Fuller"]]
base.normal.fun(k3c2_matrix)
base.normal.fun(k3c2_matrix)
base.normal.fun(k3c1_matrix)
s <- base.normal.fun(k3c1_matrix)
View(k3c1_matrix)
base.normal.fun <- function(serie){
for(col in 1:ncol(serie)){
assign(paste0("mean_", col),
mean(col))
}
}
s <- base.normal.fun(brics_matrix)
base.normal.fun(brics_matrix)
### K3C1
m_United.States <- mean(k3c1_matrix$`United States`)
m_United.States
sd_United.States <- sd(k3c1_matrix$`United States`)
len_United.States <- length(k3c1_matrix$`United States`)
base.normal_United.States <- dnorm(len_United.States,
m_United.States,
sd_United.States) #normal con los parametros de nuestras series
ks.function <- function(serie, base){
vector.series <- as.vector(serie)
ks.test(vector.series, base)
}
ks.function <- function(serie, base){
vector.series <- as.vector(serie)
ks.test(vector.series, base)
}
### K3C1
lapply(k3c1_matrix$Canada, ks.function, base)
m_United.States <- mean(indices$`United States`)
sd_United.States <- sd(indices$`United States`)
len_United.States <- length(indices$`United States`)
base.normal_United.States <- dnorm(len_United.States,
m_United.States,
sd_United.States)
ks_United.States <- ks.test(as.vector(indices$`United States`),
base.normal_United.States)
m_Australia <- mean(indices$Australia)
sd_Australia <- sd(indices$Australia)
len_Australia <- length(indices$Australia)
base.normal_Australia <- dnorm(len_Australia,
m_Australia,
sd_Australia)
ks_Australia <- ks.test(as.vector(indices$Australia),
base.normal_Australia)
class(ks_United.States)
NIG <- nigFit(indices$`United States`)
#Agrupar parametros en un objeto
a <- NIG@fit[["par"]]
a <- data.frame(t(a))
#NIG aleatoria con parametors univariados de nuestra serie
r = rnig(len,
alpha = a$alpha,
beta = a$beta,
delta = a$delta,
mu= a$mu)
plot(density(r),
col="black",
main="NIG Univariada",
sub="SP index")
#NIG aleatoria con parametors univariados de nuestra serie
r = dnig(len,
alpha = a$alpha,
beta = a$beta,
delta = a$delta,
mu= a$mu)
plot(density(r),
col="black",
main="NIG Univariada",
sub="SP index")
#NIG aleatoria con parametors univariados de nuestra serie
r = rnig(len,
alpha = a$alpha,
beta = a$beta,
delta = a$delta,
mu= a$mu)
plot(density(r),
col="black",
main="NIG Univariada",
sub="SP index")
#Parametros para NIG Multivariada
multNIG <- fit.NIGmv(data = indices,
silent = FALSE)
View(multNIG)
#Localizar parametros dentor de un obejto
Mom1NIGm <- multNIG@expected.value
Mom2NIGm <- multNIG@variance
View(indices)
m_China <- mean(indices$China)
sd_China <- sd(indices$China)
len_China <- length(indices$China)
base.normal_China <- dnorm(len_China,
m_China,
sd_China)
ks_China <- ks.test(as.vector(indices$China),
base.normal_China)
m_United.States <- mean(indices$`United States`)
sd_United.States <- sd(indices$`United States`)
len_United.States <- length(indices$`United States`)
base.normal_United.States <- dnorm(len_United.States,
m_United.States,
sd_United.States)
ks_United.States <- ks.test(as.vector(indices$`United States`),
base.normal_United.States)
m_Australia <- mean(indices$Australia)
sd_Australia <- sd(indices$Australia)
len_Australia <- length(indices$Australia)
base.normal_Australia <- dnorm(len_Australia,
m_Australia,
sd_Australia)
ks_Australia <- ks.test(as.vector(indices$Australia),
base.normal_Australia)
m_India <- mean(indices$India)
sd_India <- sd(indices$India)
len_India <- length(indices$India)
base.normal_India <- dnorm(len_India,
m_India,
sd_India)
ks_India <- ks.test(as.vector(indices$India),
base.normal_India)
m_Italy <- mean(indices$Italy)
sd_Italy <- sd(indices$Italy)
len_Italy <- length(indices$Italy)
base.normal_Italy <- dnorm(len_Italy,
m_Italy,
sd_Italy)
ks_Italy <- ks.test(as.vector(indices$Italy),
base.normal_Italy)
m_Mexico <- mean(indices$Mexico)
sd_Mexico <- sd(indices$Mexico)
len_Mexico <- length(indices$Mexico)
base.normal_Mexico <- dnorm(len_Mexico,
m_Mexico,
sd_Mexico)
ks_Mexico <- ks.test(as.vector(indices$Mexico),
base.normal_Mexico)
m_Russian.Federation <- mean(indices$`Russian Federation`)
sd_Russian.Federation <- sd(indices$`Russian Federation`)
len_Russian.Federation <- length(indices$`Russian Federation`)
base.normal_Russian.Federation <- dnorm(len_Russian.Federation,
m_Russian.Federation,
sd_Russian.Federation)
ks_Russian.Federation <- ks.test(as.vector(indices$`Russian Federation`),
base.normal_Russian.Federation)
m_Saudi.Arabia <- mean(indices$`Saudi Arabia`)
sd_Saudi.Arabia <- sd(indices$`Saudi Arabia`)
len_Saudi.Arabia <- length(indices$`Saudi Arabia`)
base.normal_Saudi.Arabia <- dnorm(len_Saudi.Arabia,
m_Saudi.Arabia,
sd_Saudi.Arabia)
ks_Saudi.Arabia <- ks.test(as.vector(indices$`Saudi Arabia`),
base.normal_Saudi.Arabia)
m_Spain <- mean(indices$Spain)
sd_Spain <- sd(indices$Spain)
len_Spain <- length(indices$Spain)
base.normal_Spain <- dnorm(len_Spain,
m_Spain,
sd_Spain)
ks_Spain <- ks.test(as.vector(indices$Spain),
base.normal_Spain)
m_Canada <- mean(indices$Canada)
sd_Canada <- sd(indices$Canada)
len_Canada <- length(indices$Canada)
base.normal_Canada <- dnorm(len_Canada,
m_Canada,
sd_Canada)
ks_Canada <- ks.test(as.vector(indices$Canada),
base.normal_Canada)
m_China <- mean(indices$China)
sd_China <- sd(indices$China)
len_China <- length(indices$China)
base.normal_China <- dnorm(len_China,
m_China,
sd_China)
ks_China <- ks.test(as.vector(indices$China),
base.normal_China)
m_France <- mean(indices$France)
sd_France <- sd(indices$France)
len_France <- length(indices$France)
base.normal_France <- dnorm(len_France,
m_France,
sd_France)
ks_France <- ks.test(as.vector(indices$France),
base.normal_France)
m_Germany <- mean(indices$Germany)
sd_Germany <- sd(indices$Germany)
len_Germany <- length(indices$Germany)
base.normal_Germany <- dnorm(len_Germany,
m_Germany,
sd_Germany)
ks_Germany <- ks.test(as.vector(indices$Germany),
base.normal_Germany)
m_Japan <- mean(indices$Japan)
sd_Japan <- sd(indices$Japan)
len_Japan <- length(indices$Japan)
base.normal_Japan <- dnorm(len_Japan,
m_Japan,
sd_Japan)
ks_Japan <- ks.test(as.vector(indices$Japan),
base.normal_Japan)
m_Korea.Rep <- mean(indices$`Korea, Rep`)
sd_Korea.Rep <- sd(indices$`Korea, Rep`)
len_Korea.Rep <- length(indices$`Korea, Rep`)
base.normal_Korea.Rep <- dnorm(len_Korea.Rep,
m_Korea.Rep,
sd_Korea.Rep)
ks_Japan <- ks.test(as.vector(indices$`Korea, Rep`),
base.normal_Korea.Rep)
m_Netherlands <- mean(indices$Netherlands)
sd_Netherlands <- sd(indices$Netherlands)
len_Netherlands <- length(indices$Netherlands)
base.normal_Netherlands <- dnorm(len_Netherlands,
m_Netherlands,
sd_Netherlands)
ks_Netherlands <- ks.test(as.vector(indices$Netherlands),
base.normal_Netherlands)
m_Switzerland <- mean(indices$Switzerland)
sd_Switzerland <- sd(indices$Switzerland)
len_Switzerland <- length(indices$Netherlands)
base.normal_Switzerland <- dnorm(len_Switzerland,
m_Switzerland,
sd_Switzerland)
ks_Switzerland <- ks.test(as.vector(indices$Switzerland),
base.normal_Switzerland)
m_United.Kingdom <- mean(indices$`United Kingdom`)
sd_United.Kingdom <- sd(indices$`United Kingdom`)
len_United.Kingdom <- length(indices$`United Kingdom`)
base.normal_United.Kingdom <- dnorm(len_United.Kingdom,
m_United.Kingdom,
sd_United.Kingdom)
ks_United.Kingdom <- ks.test(as.vector(indices$`United Kingdom`),
base.normal_United.Kingdom)
m_Brazil <- mean(indices$Brazil)
sd_Brazil <- sd(indices$Brazil)
len_Brazil <- length(indices$Brazil)
base.normal_Brazil <- dnorm(len_Brazil,
m_Brazil,
sd_Brazil)
ks_Brazil <- ks.test(as.vector(indices$Brazil),
base.normal_Brazil)
m_South.Africa <- mean(indices$`South Africa`)
sd_South.Africa <- sd(indices$`South Africa`)
len_South.Africa <- length(indices$`South Africa`)
base.normal_South.Africa <- dnorm(len_South.Africa,
m_South.Africa,
sd_South.Africa)
ks_South.Africa <- ks.test(as.vector(indices$`South Africa`),
base.normal_South.Africa)
ks.brics <- as.data.frame(c(ks_China, ks_Brazil))
View(ks.brics)
View(ks_United.States)
Serie_de_datos_el_bueno_ <- read_excel("~/Documents/GitHub/Market-Index-Portafolios/iNDICES.xlsx",
col_types = c("date", "numeric", "numeric",
"numeric", "numeric", "numeric", "numeric", "numeric"))
g1 <- Serie_de_datos_el_bueno_
colnames(g1)<-c("Fecha", "SP", "OMX30","HSI","STI","DJI","KOSPI", "DAX")
g1<-textshape::column_to_rownames(g1,loc=1)
g1 <- drop_na(g1)
retornos <- Return.calculate(g1,
method = "log")[-1,]
m <- mean(retornos$SP)
sd <- sd(retornos$SP)
len <- length(retornos$SP)
basenormal <- dnorm(len,m,sd)
#normal con los parametros de nuestras series
ks.test(retornos$SP, basenormal)
ks.test(retornos$OMX30, basenormal)
ks.test(retornos$HSI, basenormal)
ks.test(retornos$STI, basenormal)
ks.test(retornos$DJI, basenormal)
ks.test(retornos$KOSPI, basenormal)
ks.test(retornos$DAX, basenormal)
ks.brics <- as.data.frame(c(ks_Brazil[["p.value"]],
ks_Russian.Federation[["p.value"]],
ks_India[["p.value"]],
ks_China[["p.value"]],
ks_South.Africa[["p.value"]]))
View(ks.brics)
ks.brics <- as.data.frame(cbind(ks_Brazil[["p.value"]],
ks_Russian.Federation[["p.value"]],
ks_India[["p.value"]],
ks_China[["p.value"]],
ks_South.Africa[["p.value"]]))
ks_South.Africa <- as.data.frame(ks.test(as.vector(indices$`South Africa`),
base.normal_South.Africa))
ks_South.Africa <- ks.test(as.vector(indices$`South Africa`),
base.normal_South.Africa)
View(ks_South.Africa)
ks_South.Africa <- as.data.frame(ks_South.Africa[["p.value"]])
View(ks_South.Africa)
colnames(ks_South.Africa$`ks_South.Africa[["p.value"]]`)<- ks_South.Africa
colnames(ks_South.Africa$`ks_South.Africa[["p.value"]]`)<- "ks_South.Africa"
ks_South.Africa <- as.data.frame(ks_South.Africa[["p.value"]])
m_South.Africa <- mean(indices$`South Africa`)
sd_South.Africa <- sd(indices$`South Africa`)
len_South.Africa <- length(indices$`South Africa`)
base.normal_South.Africa <- dnorm(len_South.Africa,
m_South.Africa,
sd_South.Africa)
ks_South.Africa <- ks.test(as.vector(indices$`South Africa`),
base.normal_South.Africa)
ks_South.Africa <- as.data.frame(ks_South.Africa[["p.value"]])
View(ks_South.Africa)
m_Brazil <- mean(indices$Brazil)
sd_Brazil <- sd(indices$Brazil)
len_Brazil <- length(indices$Brazil)
base.normal_Brazil <- dnorm(len_Brazil,
m_Brazil,
sd_Brazil)
ks_Brazil <- ks.test(as.vector(indices$Brazil),
base.normal_Brazil)
ks_Brazil <- as.data.frame(ks_Brazil[["p.value"]])
View(ks_Brazil)
m_China <- mean(indices$China)
sd_China <- sd(indices$China)
len_China <- length(indices$China)
base.normal_China <- dnorm(len_China,
m_China,
sd_China)
ks_China <- ks.test(as.vector(indices$China),
base.normal_China)
ks_China <- as.data.frame(ks_China[["p.value"]])
m_Russian.Federation <- mean(indices$`Russian Federation`)
sd_Russian.Federation <- sd(indices$`Russian Federation`)
len_Russian.Federation <- length(indices$`Russian Federation`)
base.normal_Russian.Federation <- dnorm(len_Russian.Federation,
m_Russian.Federation,
sd_Russian.Federation)
ks_Russian.Federation <- ks.test(as.vector(indices$`Russian Federation`),
base.normal_Russian.Federation)
ks_Russian.Federation <- as.data.frame(ks_Russian.Federation[["p.value"]])
m_India <- mean(indices$India)
sd_India <- sd(indices$India)
len_India <- length(indices$India)
base.normal_India <- dnorm(len_India,
m_India,
sd_India)
ks_India <- ks.test(as.vector(indices$India),
base.normal_India)
ks_India <- as.data.frame(ks_India[["p.value"]])
ks.brics <- cbind(ks_Brazil,
ks_Russian.Federation,
ks_India,
ks_China,
ks_South.Africa)
View(ks.brics)
colnames(ks.brics) <- brics
rownames(ks.brics) <- "p.value"
ks_Brazil <- ks.test(indices$Brazil,
base.normal_Brazil)
ks_Brazil <- ks.test(as.vector(indices$Brazil),
base.normal_Brazil)
ks_Brazil <- as.data.frame(ks_Brazil[["p.value"]])
View(ks_Netherlands)
ks.test(retornos$SP, basenormal)
install.packages("fasano.franceschini.test")
library(fasano.franceschini.test)
fasano.franceschini.test(indices$`United States`, base.normal_United.States)
#Construccion de normal con parametros multivariados de la series
base.normal_United.States
class(base.normal_United.States)
m <- mean(retornos$SP)
sd <- sd(retornos$SP)
len <- length(retornos$SP)
basenormal <- dnorm(len,m,sd)
ks.test(retornos$SP, basenormal)
class(basenormal)
ks.test(retornos$SP, "NIG")
basenormal <- pnorm(len,m,sd)
ks.test(retornos$SP, basenormal)
base.normal_Brazil <- pnorm(len_Brazil,
m_Brazil,
sd_Brazil)
ks_Brazil <- ks.test(as.vector(indices$Brazil),
base.normal_Brazil)
ks_Brazil
View(ks.brics)
base.normal_Brazil <- dnorm(len_Brazil,
m_Brazil,
sd_Brazil)
ks_Brazil <- ks.test(as.vector(indices$Brazil),
base.normal_Brazil)
ks_Brazil
m_United.States <- mean(indices$`United States`)
sd_United.States <- sd(indices$`United States`)
len_United.States <- length(indices$`United States`)
base.normal_United.States <- dnorm(len_United.States,
m_United.States,
sd_United.States)
#### ks tests
ks_United.States <- ks.test(as.vector(indices$`United States`),
base.normal_United.States)
ks_United.States <- as.data.frame(ks_United.States[["p.value"]])
View(ks_United.States)
